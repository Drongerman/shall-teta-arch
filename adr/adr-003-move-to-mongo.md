# [ADR.003][Опредение необходимости перехода с реляционной БД на Mongo DB]

* Статус: Предложено
* Владелец: asshalunov@mts.ru

## Контекст
Мы расширяем систему HelloConf для проведения еще и онлайн курсов. Система использует реляционную базу данных Postgres. Ожидается, что число пользователей системы может достигнуть 10 000 CAU (concurrent active users). В связи с этим возникает вопрос о необходимости перехода на нереляционную базу данных MongoDB.

## Варианты решения

Оценка факторов по 5-бальной шкале:

| Фактор | Postgres | MongoDB |
| --- | --- | --- |
| Масштабируемость | 3 | 5 |
| Гибкость | 4 | 5 |
| Сложность разработки | 4 | 2 |
| Совместимость с существующими инструментами (e.g. Java Spring) | 5 | 4 |
| Надежность | 5 | 4 |
| Поддержка Json в каждой БД | 4 | 5 |
| Итого | 25 | 25 |

Оценка критичности данных факторов для продукта по 5-бальной шкале:

| Фактор | Критичность |
| --- | --- |
| Масштабируемость | 5 |
| Гибкость | 4 |
| Сложность разработки | 3 |
| Сложность миграции | 2 |
| Совместимость с существующими инструментами (Java Spring) | 4 |
| Надежность | 4 |
| Поддержка Json в каждой БД | 5 |

## Обоснование

### Масштабируемость

* MongoDB позволяет горизонтальное масштабирование, что позволит легко увеличивать количество пользователей системы. Postgres, в свою очередь, имеет ограничения на масштабирование и может стать узким местом при увеличении числа пользователей.

### Гибкость

* MongoDB позволяет гибко управлять структурой данных и быстро вносить изменения в схему. Это может быть полезно, если мы планируем вносить изменения в систему в будущем. 

### Сложность разработки

* Переход на MongoDB потребует дополнительных знаний и опыта в области нереляционных баз данных. Это может привести к сложностям в разработке и поддержке системы. 

### Совместимость с существующими инструментами (Java Spring)

* Postgres хорошо интегрирован с другими инструментами, такими как ORM и BI-системы. MongoDB может потребовать дополнительной работы для интеграции с существующими инструментами. 

### Надежность

* Postgres предлагает более высокий уровень надежности и целостности данных, чем MongoDB.

### Поддержка Json в каждой БД

* MongoDB и Postgres оба поддерживают Json, однако MongoDB лучше подходит для работы с JSON-документами, чем Postgres


## Решение
Postgre и Mongo набрали одинаковое количество баллов, однако, учитывая более высокую важность масштабируемости, гибкости и удобаства работы с Json, мы приняли решение о переходе с реляционной Postgres на нереляционную MongoDB. Это обеспечит лучшую масштабируемость и гибкость схемы данных, что важно для системы проведения онлайн курсов с ожидаемым числом пользователей 10 000 CAU.

### Последствия
Переход на MongoDB может потребовать дополнительных затрат на разработку и интеграцию с существующими инструментами.

